"use strict";(()=>{var e={};e.id=354,e.ids=[354],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5024:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>E,staticGenerationAsyncStorage:()=>d});var o={};t.r(o),t.d(o,{POST:()=>l});var n=t(9303),s=t(8716),a=t(670),i=t(7070),c=t(4392);async function l(e){try{let{imageUrl:r}=await e.json();if(!r||"string"!=typeof r)return i.NextResponse.json({error:"Image URL is required"},{status:400});console.log("\uD83D\uDDD1️ Delete Image API: Received request",{imageUrl:r});let t=(0,c.cl)(r);if(!t)return console.error("❌ Delete Image API: Could not extract path from URL",{imageUrl:r}),i.NextResponse.json({error:"Invalid image URL format"},{status:400});return console.log("\uD83D\uDDD1️ Delete Image API: Deleting from Hetzner...",{path:t}),await (0,c._I)(t),console.log("✅ Delete Image API: Deleted successfully",{path:t}),i.NextResponse.json({success:!0,path:t},{status:200})}catch(r){console.error("❌ Delete Image API error:",r);let e=r instanceof Error?r.message:"Delete failed";return i.NextResponse.json({error:e},{status:500})}}let u=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/delete-image/route",pathname:"/api/delete-image",filename:"route",bundlePath:"app/api/delete-image/route"},resolvedPagePath:"/home/paas/Hope properties/app/api/delete-image/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:E}=u,m="/api/delete-image/route";function f(){return(0,a.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:d})}},4392:(e,r,t)=>{t.d(r,{_I:()=>u,cl:()=>p,cT:()=>l});let o=require("@aws-sdk/client-s3");function n(){return new o.S3Client({endpoint:process.env.HETZNER_S3_ENDPOINT,region:process.env.HETZNER_S3_REGION||"fsn1",credentials:{accessKeyId:process.env.HETZNER_S3_ACCESS_KEY||"",secretAccessKey:process.env.HETZNER_S3_SECRET_KEY||""},forcePathStyle:!0})}let s=process.env.HETZNER_S3_BUCKET||"hope-properties-images",a=process.env.HETZNER_CDN_URL,i=process.env.HETZNER_S3_ENDPOINT,c="false"!==process.env.HETZNER_S3_BUCKET_PUBLIC;async function l(e,r,t="image/jpeg"){let l=n(),u=new o.PutObjectCommand({Bucket:s,Key:r,Body:e,ContentType:t,CacheControl:"public, max-age=31536000",...c?{ACL:"public-read"}:{}});try{if(await l.send(u),!c&&!a)throw Error("Private bucket requires HETZNER_CDN_URL to be configured");if(a)return`${a}/${r}`;if(i&&c)return`${i}/${s}/${r}`;throw Error("No CDN URL or public S3 endpoint configured")}catch(e){throw console.error("❌ Upload failed:",e),Error(`Failed to upload file: ${e instanceof Error?e.message:"Unknown error"}`)}}async function u(e){let r=n(),t=new o.DeleteObjectCommand({Bucket:s,Key:e});try{await r.send(t)}catch(e){throw console.error("❌ Delete failed:",e),Error(`Failed to delete file: ${e instanceof Error?e.message:"Unknown error"}`)}}function p(e){try{if(a&&e.startsWith(a))return e.replace(a+"/","");if((process.env.NEXT_PUBLIC_HETZNER_S3_ENDPOINT||process.env.HETZNER_S3_ENDPOINT)&&e.includes(`/${s}/`))return e.split(`/${s}/`)[1]||null;let r=new URL(e);return r.pathname.startsWith("/")?r.pathname.slice(1):r.pathname}catch{return null}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(5024));module.exports=o})();