(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9370:function(e,t,s){Promise.resolve().then(s.t.bind(s,8877,23)),Promise.resolve().then(s.bind(s,6335))},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},6335:function(e,t,s){"use strict";s.d(t,{Header:function(){return h}});var a=s(7437),r=s(4232),n=s(2022),l=s(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,l.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var o=s(4697);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,l.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var d=s(2265),u=s(7138),m=s(6463),x=s(4316);function g(e){let{onClose:t,onSuccess:s}=e,[r,n]=(0,d.useState)(!1),[l,i]=(0,d.useState)(!1),[c,u]=(0,d.useState)(""),[m,g]=(0,d.useState)(!1),[h,b]=(0,d.useState)(!1),[p,y]=(0,d.useState)({email:"",password:"",full_name:"",phone:"",user_type:"agent",location_country:"",location_city:""}),f=async e=>{e.preventDefault(),i(!0),u("");try{if(r){if(!p.location_country||!p.location_city){u("Please provide your location (Country and City)"),i(!1);return}let{data:e,error:t}=await x.supabase.auth.signUp({email:p.email,password:p.password});if(t)throw t;if(e.user){let t="".concat(p.location_city,", ").concat(p.location_country),s="malawi"!==p.location_country.toLowerCase(),{error:a}=await x.supabase.from("profiles").insert({id:e.user.id,email:p.email,full_name:p.full_name,phone:p.phone,current_location:t,is_diaspora:s,user_type:p.user_type});if(a)throw a;if("agent"===p.user_type){let{error:t}=await x.supabase.from("agents").insert({user_id:e.user.id,verification_status:"pending"});if(t&&!t.message.includes("duplicate"))throw t}}}else{let{error:e}=await x.supabase.auth.signInWithPassword({email:p.email,password:p.password});if(e)throw e}s()}catch(e){u(e.message||"Authentication failed")}finally{i(!1)}},j=async e=>{e.preventDefault(),i(!0),u("");try{if(!p.email){u("Please enter your email address"),i(!1);return}let{error:e}=await x.supabase.auth.resetPasswordForEmail(p.email,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(e)throw e;b(!0)}catch(e){u(e.message||"Failed to send password reset email")}finally{i(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:r?"List Your Property":"Sign In"}),r&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Sign up to list properties as an Agent or Property Owner"})]}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(o.Z,{size:24})})]}),(0,a.jsxs)("form",{onSubmit:f,className:"p-6",children:[c&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm",children:c}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,a.jsx)("input",{type:"email",required:!0,value:p.email,onChange:e=>y({...p,email:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Password *"}),!r&&(0,a.jsx)("button",{type:"button",onClick:()=>g(!0),className:"text-sm text-blue-600 hover:underline",children:"Forgot password?"})]}),(0,a.jsx)("input",{type:"password",required:!m,value:p.password,onChange:e=>y({...p,password:e.target.value}),disabled:m,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:p.full_name,onChange:e=>y({...p,full_name:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",value:p.phone,onChange:e=>y({...p,phone:e.target.value}),placeholder:"e.g., +265 991 123 456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"I am registering as *"}),(0,a.jsxs)("select",{required:!0,value:p.user_type,onChange:e=>y({...p,user_type:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"agent",children:"Real Estate Agent"}),(0,a.jsx)("option",{value:"owner",children:"Property Owner"})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Where are you located? * ",(0,a.jsx)("span",{className:"text-xs text-gray-500 font-normal",children:"(Required for data mining)"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Country *"}),(0,a.jsx)("input",{type:"text",required:!0,value:p.location_country,onChange:e=>y({...p,location_country:e.target.value}),placeholder:"e.g., Malawi, South Africa",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"City *"}),(0,a.jsx)("input",{type:"text",required:!0,value:p.location_city,onChange:e=>y({...p,location_city:e.target.value}),placeholder:"e.g., Lilongwe, Johannesburg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"This helps us understand where sellers are located for market intelligence."})]})]})]}),m?(0,a.jsx)(a.Fragment,{children:h?(0,a.jsxs)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-green-800 font-medium mb-2",children:"✅ Password reset email sent!"}),(0,a.jsxs)("p",{className:"text-sm text-green-700",children:["Check your email (",p.email,") for a password reset link. Click the link to reset your password."]}),(0,a.jsx)("button",{type:"button",onClick:()=>{g(!1),b(!1)},className:"mt-4 text-sm text-blue-600 hover:underline",children:"Back to Sign In"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",onClick:j,disabled:l||!p.email,className:"w-full mt-6 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Sending...":"Send Reset Link"}),(0,a.jsx)("button",{type:"button",onClick:()=>g(!1),className:"w-full mt-3 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-gray-700",children:"Cancel"})]})}):(0,a.jsx)("button",{type:"submit",disabled:l,className:"w-full mt-6 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Loading...":r?"Create Account":"Sign In"}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>n(!r),className:"text-blue-600 hover:underline text-sm",children:r?"Already have an account? Sign in":"Don't have an account? Sign up"})}),r&&(0,a.jsx)("p",{className:"mt-4 text-xs text-center text-gray-500",children:"Note: Buyers don't need to sign up. You can browse properties and fill a simple form to see details."})]})]})})}function h(){var e,t,s,l;let[h,b]=(0,d.useState)(null),[p,y]=(0,d.useState)(null),[f,j]=(0,d.useState)(!1),[v,w]=(0,d.useState)(!1),N=(0,m.usePathname)(),k=(0,m.useRouter)();(0,d.useEffect)(()=>{_();let{data:{subscription:e}}=x.supabase.auth.onAuthStateChange(()=>{(async()=>{await _()})()});return()=>{e.unsubscribe()}},[]);let _=async()=>{let{data:{user:e}}=await x.supabase.auth.getUser();if(e){let{data:t}=await x.supabase.from("profiles").select("*").eq("id",e.id).maybeSingle();b(t),y(t)}else b(null),y(null)},C=async()=>{await x.supabase.auth.signOut(),b(null),k.push("/")};return(0,d.useEffect)(()=>{w(!1)},[N]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)(u.default,{href:"/",className:"flex items-center gap-2 text-lg sm:text-xl font-bold text-gray-900 hover:text-blue-600 transition-colors",onClick:()=>w(!1),children:[(0,a.jsx)(r.Z,{size:24,className:"sm:w-7 sm:h-7"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Malawi Properties"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Malawi"})]}),(0,a.jsxs)("nav",{className:"hidden lg:flex items-center gap-4",children:[(0,a.jsx)(u.default,{href:"/",className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat("/"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Marketplace"}),p&&"admin"===p.user_type&&(0,a.jsx)(u.default,{href:"/admin",className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat("/admin"===N?"bg-red-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Admin"}),p&&"buyer"===p.user_type&&(0,a.jsx)(u.default,{href:"/buyer",className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat("/buyer"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"My Dashboard"}),p&&("agent"===p.user_type||"owner"===p.user_type)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.default,{href:"/dashboard",className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat("/dashboard"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Dashboard"}),(0,a.jsx)(u.default,{href:"/analytics",className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat("/analytics"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Analytics"}),(0,a.jsx)(u.default,{href:"/intelligence",className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat("/intelligence"===N?"bg-purple-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Intelligence"})]}),h?(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg",children:[(0,a.jsx)(n.Z,{size:18}),(0,a.jsx)("span",{className:"text-sm font-medium hidden xl:inline",children:h.full_name||h.email}),(0,a.jsx)("span",{className:"text-sm font-medium xl:hidden",children:(null===(e=h.full_name)||void 0===e?void 0:e.split(" ")[0])||(null===(t=h.email)||void 0===t?void 0:t.split("@")[0])})]}),(0,a.jsx)("button",{onClick:C,className:"p-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Sign out",children:(0,a.jsx)(i,{size:20})})]}):(0,a.jsx)("button",{onClick:()=>j(!0),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium min-h-[44px]",children:"Sign In"})]}),(0,a.jsxs)("div",{className:"lg:hidden flex items-center gap-2",children:[h&&(0,a.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 bg-gray-100 rounded-lg",children:[(0,a.jsx)(n.Z,{size:18}),(0,a.jsx)("span",{className:"text-xs font-medium max-w-[80px] truncate",children:(null===(s=h.full_name)||void 0===s?void 0:s.split(" ")[0])||(null===(l=h.email)||void 0===l?void 0:l.split("@")[0])})]}),(0,a.jsx)("button",{onClick:()=>w(!v),className:"p-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Toggle menu",children:v?(0,a.jsx)(o.Z,{size:24}):(0,a.jsx)(c,{size:24})})]})]}),v&&(0,a.jsxs)("nav",{className:"lg:hidden border-t border-gray-200 py-4 space-y-2",children:[(0,a.jsx)(u.default,{href:"/",onClick:()=>w(!1),className:"block px-4 py-3 rounded-lg transition-colors text-base font-medium ".concat("/"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Marketplace"}),p&&"admin"===p.user_type&&(0,a.jsx)(u.default,{href:"/admin",onClick:()=>w(!1),className:"block px-4 py-3 rounded-lg transition-colors text-base font-medium ".concat("/admin"===N?"bg-red-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Admin"}),p&&"buyer"===p.user_type&&(0,a.jsx)(u.default,{href:"/buyer",onClick:()=>w(!1),className:"block px-4 py-3 rounded-lg transition-colors text-base font-medium ".concat("/buyer"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"My Dashboard"}),p&&("agent"===p.user_type||"owner"===p.user_type)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.default,{href:"/dashboard",onClick:()=>w(!1),className:"block px-4 py-3 rounded-lg transition-colors text-base font-medium ".concat("/dashboard"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Dashboard"}),(0,a.jsx)(u.default,{href:"/analytics",onClick:()=>w(!1),className:"block px-4 py-3 rounded-lg transition-colors text-base font-medium ".concat("/analytics"===N?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Analytics"}),(0,a.jsx)(u.default,{href:"/intelligence",onClick:()=>w(!1),className:"block px-4 py-3 rounded-lg transition-colors text-base font-medium ".concat("/intelligence"===N?"bg-purple-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Intelligence"})]}),!h&&(0,a.jsx)("button",{onClick:()=>{w(!1),j(!0)},className:"w-full text-left px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-base min-h-[44px]",children:"Sign In"}),h&&(0,a.jsxs)("button",{onClick:()=>{w(!1),C()},className:"w-full text-left px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium text-base min-h-[44px] flex items-center gap-2",children:[(0,a.jsx)(i,{size:20}),"Sign Out"]})]})]})}),f&&(0,a.jsx)(g,{onClose:()=>j(!1),onSuccess:()=>{j(!1),_()}})]})}},4316:function(e,t,s){"use strict";s.d(t,{supabase:function(){return i}});var a=s(6887);let r="https://ofuyghemecqstflnhixy.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mdXlnaGVtZWNxc3RmbG5oaXh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMDQ0NzUsImV4cCI6MjA3ODg4MDQ3NX0.kD12l4KnDFZuRNFCSOEIQWKCGdvy8CBCnuL2ukC0TAc",l=r?r.replace(/\/$/,"").replace(/^(https?:\/\/)?/,"https://"):"https://placeholder.supabase.co";r&&n?n.length<50&&console.error("❌ Invalid Supabase anon key:",{keyLength:n.length,keyPreview:n.substring(0,30)+"...",message:"Anon key appears to be a placeholder or too short. Please check Vercel environment variables."}):(console.error("❌ Missing Supabase environment variables:",{url:r?"✓":"✗",key:n?"✓":"✗",urlValue:r||"MISSING",keyValue:n?"".concat(n.substring(0,20),"..."):"MISSING"}),console.error("Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in Vercel environment variables and redeploy."));let i=(0,a.eI)(l,n||"placeholder-key",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},8877:function(){}},function(e){e.O(0,[404,432,317,971,23,744],function(){return e(e.s=9370)}),_N_E=e.O()}]);