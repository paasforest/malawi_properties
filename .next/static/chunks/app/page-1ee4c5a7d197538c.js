(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1347:function(e,t,r){Promise.resolve().then(r.bind(r,3045))},8281:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},5862:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},4436:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},4453:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},2513:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4817:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},500:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},3225:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},1240:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},3230:function(e,t,r){"use strict";r.d(t,{getCurrentSessionId:function(){return d},getOrCreateSession:function(){return l},x:function(){return c}});var s=r(4316);let a=null,i=null;async function l(){if(a&&i){if(Date.now()-i.getTime()<18e5)return a;a&&await n(a)}try{let{data:{user:e}}=await s.supabase.auth.getUser(),t=await o(),r=/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)?"mobile":"desktop",l=document.referrer||null,{data:n,error:c}=await s.supabase.from("user_sessions").insert({user_id:(null==e?void 0:e.id)||null,session_start:new Date().toISOString(),viewer_location:t.location,viewer_country:t.country,viewer_city:t.city,viewer_origin_type:t.originType,device_type:r,referrer:l,user_agent:navigator.userAgent,conversion_funnel:{searches:0,views:0,detail_views:0,inquiries:0}}).select("id").single();if(c)return console.error("Error creating session:",c),null;return a=n.id,i=new Date,a}catch(e){return console.error("Error in getOrCreateSession:",e),null}}async function n(e){try{await s.supabase.rpc("end_user_session",{session_uuid:e}),a=null,i=null}catch(e){console.error("Error ending session:",e)}}async function o(){try{let{data:{user:e}}=await s.supabase.auth.getUser();if(e){let{data:t}=await s.supabase.from("profiles").select("current_location, is_diaspora").eq("id",e.id).maybeSingle();if(null==t?void 0:t.current_location){let e=t.current_location.split(", ");return{location:t.current_location,country:e[e.length-1]||"Unknown",city:e[0]||"Unknown",originType:t.is_diaspora?"diaspora":"local",localCity:null}}}return{location:"Unknown",country:"Unknown",city:"Unknown",originType:null,localCity:null}}catch(e){return console.error("Error getting viewer location:",e),{location:"Unknown",country:"Unknown",city:"Unknown",originType:null,localCity:null}}}async function c(e,t,r,a){if(!e&&!(e=await l()))return null;try{let{data:{user:i}}=await s.supabase.auth.getUser(),{data:l,error:n}=await s.supabase.from("search_queries").insert({user_id:(null==i?void 0:i.id)||null,session_id:e,search_text:t||null,search_params:r,results_count:a}).select("id").single();if(n)return console.error("Error tracking search query:",n),null;try{await s.supabase.rpc("update_user_session_search_count",{session_uuid:e})}catch(e){}return l.id}catch(e){return console.error("Error in trackSearchQuery:",e),null}}function d(){return a}window.addEventListener("beforeunload",()=>{if(a){let e="".concat(window.location.origin,"/api/end-session");navigator.sendBeacon(e,JSON.stringify({sessionId:a}))}})},3045:function(e,t,r){"use strict";r.d(t,{Marketplace:function(){return et}});var s=r(7437),a=r(2265),i=r(4316),l=r(2639),n=r(4817),o=r(3230);function c(e){let{filters:t,onChange:r,districts:i,resultsCount:l=0}=e,c=(0,a.useRef)(null),d=(0,a.useRef)("");return(0,a.useEffect)(()=>{c.current&&clearTimeout(c.current);let e=JSON.stringify({search:t.search,propertyType:t.propertyType,district:t.district,minPrice:t.minPrice,maxPrice:t.maxPrice,currency:t.currency});if(e!==d.current)return c.current=setTimeout(async()=>{if(t.search||t.propertyType||t.district||t.minPrice||t.maxPrice||t.currency){let r=(0,o.getCurrentSessionId)();r&&(await (0,o.x)(r,t.search,{district:t.district||void 0,propertyType:t.propertyType||void 0,minPrice:t.minPrice||void 0,maxPrice:t.maxPrice||void 0,currency:t.currency||void 0},l),d.current=e)}},1e3),()=>{c.current&&clearTimeout(c.current)}},[t,l]),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"relative lg:col-span-3",children:[(0,s.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)("input",{type:"text",placeholder:"Search properties...",value:t.search,onChange:e=>r({...t,search:e.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("select",{value:t.propertyType,onChange:e=>r({...t,propertyType:e.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"All Property Types"}),(0,s.jsx)("option",{value:"land",children:"Land"}),(0,s.jsx)("option",{value:"house",children:"House"}),(0,s.jsx)("option",{value:"rental",children:"Rental"}),(0,s.jsx)("option",{value:"commercial",children:"Commercial"}),(0,s.jsx)("option",{value:"mixed",children:"Mixed Use"})]}),(0,s.jsxs)("select",{value:t.district,onChange:e=>r({...t,district:e.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"All Districts"}),i.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsxs)("select",{value:t.currency,onChange:e=>r({...t,currency:e.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"All Currencies"}),(0,s.jsx)("option",{value:"MWK",children:"MWK"}),(0,s.jsx)("option",{value:"USD",children:"USD"}),(0,s.jsx)("option",{value:"ZAR",children:"ZAR"})]}),(0,s.jsx)("input",{type:"number",placeholder:"Min Price",value:t.minPrice,onChange:e=>r({...t,minPrice:e.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("input",{type:"number",placeholder:"Max Price",value:t.maxPrice,onChange:e=>r({...t,maxPrice:e.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})}var d=r(4697),u=r(9321),x=r(8592),m=r(2468),g=r(9778),p=r(3850),h=r(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,h.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var b=r(4241);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,h.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var v=r(2022),j=r(1077);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let w=(0,h.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),N=(0,h.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);function _(e){let{property:t,onDetailsUnlocked:r,onClose:l}=e,[n,o]=(0,a.useState)({buyer_name:"",buyer_origin_type:"",buyer_country:"",buyer_city:"",local_origin_city:"",budget_range:"",intended_use:"",payment_method_preference:""}),[c,x]=(0,a.useState)(!1),[m,g]=(0,a.useState)(""),p=async e=>{if(e.preventDefault(),x(!0),g(""),!n.buyer_name||!n.buyer_origin_type){g("Please fill in all required fields"),x(!1);return}try{var s;let e=n.buyer_origin_type||((null===(s=n.buyer_country)||void 0===s?void 0:s.toLowerCase())==="malawi"?"local":"diaspora"),a=/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)?"mobile":"desktop",l="local"===e?"Malawi":n.buyer_country,o="local"===e?n.local_origin_city:n.buyer_city,c="local"===e?"".concat(o,", Malawi"):"".concat(n.buyer_city,", ").concat(n.buyer_country),{error:d}=await i.supabase.from("property_views").insert({property_id:t.id,viewer_id:null,viewer_location:c,viewer_country:l,viewer_city:o,viewer_origin_type:e,viewer_local_city:"local"===e?n.local_origin_city:null,device_type:a,viewing_duration:0});if(d)throw d;await i.supabase.from("properties").update({views_count:t.views_count+1}).eq("id",t.id),r(n)}catch(e){g("Failed to submit. Please try again."),console.error(e)}finally{x(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Get Property Details"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Help us connect you with the seller"})]}),(0,s.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsx)("div",{className:"p-6 bg-gray-50 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[t.images&&t.images.length>0&&(0,s.jsx)("img",{src:t.images[0],alt:t.title,className:"w-24 h-24 object-cover rounded-lg"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-1",children:t.title}),(0,s.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:[(0,s.jsx)(u.Z,{size:14,className:"inline mr-1"}),t.area?"".concat(t.area,", "):"",t.district]}),(0,s.jsxs)("p",{className:"text-xl font-bold text-blue-600",children:[t.currency," ",t.price.toLocaleString()]})]})]})}),(0,s.jsxs)("form",{onSubmit:p,className:"p-6",children:[m&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm",children:m}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[(0,s.jsx)(v.Z,{size:16}),"Your Name *"]}),(0,s.jsx)("input",{type:"text",required:!0,value:n.buyer_name,onChange:e=>o({...n,buyer_name:e.target.value}),placeholder:"e.g., John Mwale",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[(0,s.jsx)(u.Z,{size:16}),"Are you living in Malawi or outside? *"]}),(0,s.jsxs)("select",{required:!0,value:n.buyer_origin_type,onChange:e=>{let t=e.target.value;o({...n,buyer_origin_type:t,buyer_country:"local"===t?"Malawi":n.buyer_country,local_origin_city:"local"===t?n.local_origin_city:""})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select..."}),(0,s.jsx)("option",{value:"local",children:"Local (Living in Malawi)"}),(0,s.jsx)("option",{value:"diaspora",children:"Diaspora (Living outside Malawi)"})]})]}),"local"===n.buyer_origin_type?(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Which city in Malawi are you from? *"}),(0,s.jsxs)("select",{required:!0,value:n.local_origin_city,onChange:e=>o({...n,local_origin_city:e.target.value,buyer_city:e.target.value,buyer_country:"Malawi"}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select your city"}),["Lilongwe","Blantyre","Mzuzu","Zomba","Kasungu","Mangochi","Karonga","Salima","Nkhotakota","Liwonde","Nsanje","Mchinji","Dedza","Dowa","Ntcheu","Balaka","Mulanje","Thyolo","Other"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}):"diaspora"===n.buyer_origin_type?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.buyer_country,onChange:e=>o({...n,buyer_country:e.target.value}),placeholder:"e.g., South Africa, UK, USA",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.buyer_city,onChange:e=>o({...n,buyer_city:e.target.value}),placeholder:"e.g., Johannesburg, London",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}):null,(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[(0,s.jsx)(j.Z,{size:16}),"Budget Range (optional)"]}),(0,s.jsx)("input",{type:"text",value:n.budget_range,onChange:e=>o({...n,budget_range:e.target.value}),placeholder:"e.g., MK 20M-30M",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[(0,s.jsx)(w,{size:16}),"Intended Use (optional)"]}),(0,s.jsxs)("select",{value:n.intended_use,onChange:e=>o({...n,intended_use:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select intended use"}),(0,s.jsx)("option",{value:"Home Build",children:"Home Build"}),(0,s.jsx)("option",{value:"Rental Income",children:"Rental Income"}),(0,s.jsx)("option",{value:"Farming",children:"Farming"}),(0,s.jsx)("option",{value:"Commercial",children:"Commercial"}),(0,s.jsx)("option",{value:"Investment",children:"Investment"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-2",children:[(0,s.jsx)(N,{size:16}),"Payment Method Preference (optional)"]}),(0,s.jsxs)("select",{value:n.payment_method_preference,onChange:e=>o({...n,payment_method_preference:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select payment method"}),(0,s.jsx)("option",{value:"Bank Transfer",children:"Bank Transfer"}),(0,s.jsx)("option",{value:"Cash",children:"Cash"}),(0,s.jsx)("option",{value:"Installments",children:"Installments"}),(0,s.jsx)("option",{value:"Mortgage",children:"Mortgage"})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:l,className:"flex-1 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Loading...":"View Full Details"})]}),(0,s.jsx)("p",{className:"text-xs text-center text-gray-500 mt-4",children:"Your information helps us provide better service. We respect your privacy."})]})]})})}var k=r(1057);function C(e){var t,l;let{property:n,onClose:o,onInquire:c}=e,[h,v]=(0,a.useState)(0),[j,w]=(0,a.useState)(null),[N,C]=(0,a.useState)(null),[z,M]=(0,a.useState)(!0),[S,Z]=(0,a.useState)(!1),[P,L]=(0,a.useState)(!1),[q,A]=(0,a.useState)(null),[D,T]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{let{data:{user:e}}=await i.supabase.auth.getUser();if(e){let{data:t}=await i.supabase.from("profiles").select("user_type").eq("id",e.id).maybeSingle(),r=(null==t?void 0:t.user_type)==="agent"||(null==t?void 0:t.user_type)==="owner";T(r),r&&L(!0)}})(),E()},[n]);let E=async()=>{try{if(M(!0),n.agent_id){let{data:e}=await i.supabase.from("agents").select("user_id").eq("id",n.agent_id).maybeSingle();if(null==e?void 0:e.user_id){let{data:t}=await i.supabase.from("profiles").select("full_name, email, phone").eq("id",e.user_id).maybeSingle();w(t||null)}}if(n.owner_id){let{data:e}=await i.supabase.from("profiles").select("full_name, email, phone").eq("id",n.owner_id).maybeSingle();C(e||null)}}catch(e){console.error("Error loading contact info:",e)}finally{M(!1)}};return((0,a.useEffect)(()=>{if(!P)return;let e=Date.now(),t=null;return(async()=>{let{data:{user:e}}=await i.supabase.auth.getUser(),s=null,a=null,l=null,o=null,c=null;if(q)a="local"==(o="local"===q.buyer_origin_type?"local":"diaspora")?"Malawi":q.buyer_country,l="local"===o?q.local_origin_city:q.buyer_city,s="local"===o?"".concat(l,", Malawi"):"".concat(q.buyer_city,", ").concat(q.buyer_country),c="local"===o?q.local_origin_city:null;else if(e){let{data:t}=await i.supabase.from("profiles").select("current_location, is_diaspora, buyer_origin_type, local_origin_city").eq("id",e.id).maybeSingle();if(null==t?void 0:t.current_location){s=t.current_location;let e=t.current_location.split(",").map(e=>e.trim());e.length>=2?(l=e[0],a=e[1]):a=e[0],o=t.is_diaspora?"diaspora":"local",c=t.local_origin_city||null}}let d=/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)?"mobile":"desktop",{getCurrentSessionId:u,getOrCreateSession:x}=await Promise.resolve().then(r.bind(r,3230)),m=u();m||(m=await x());let{data:g}=await i.supabase.from("property_views").insert({property_id:n.id,viewer_id:(null==e?void 0:e.id)||null,viewer_location:s,viewer_country:a,viewer_city:l,viewer_origin_type:o,viewer_local_city:c,device_type:d,session_id:m,viewing_duration:0,referrer:document.referrer||null,user_agent:navigator.userAgent}).select("id").single();g&&(t=g.id),await i.supabase.from("properties").update({views_count:n.views_count+1}).eq("id",n.id)})(),()=>{let r=Math.floor((Date.now()-e)/1e3);t&&r>3&&i.supabase.from("property_views").update({viewing_duration:r}).eq("id",t).then(()=>{})}},[n.id,P,q]),S&&!P)?(0,s.jsx)(_,{property:n,onDetailsUnlocked:e=>{A(e),L(!0),Z(!1)},onClose:()=>{Z(!1),o()}}):P||D?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-0 sm:p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-none sm:rounded-lg max-w-4xl w-full h-full sm:h-auto max-h-full sm:max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-3 sm:p-4 flex items-center justify-between z-10",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 pr-2 truncate",children:n.title}),(0,s.jsx)("button",{onClick:o,className:"p-2 hover:bg-gray-100 active:bg-gray-200 rounded-full transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center flex-shrink-0","aria-label":"Close",children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsxs)("div",{className:"p-4 sm:p-6",children:[(()=>{let e=(0,k.DQ)(n.images);if(e.length>0){let t=Math.min(h,e.length-1);return(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"relative h-48 sm:h-64 md:h-96 bg-gray-200 rounded-lg overflow-hidden",children:[(0,s.jsx)("img",{src:(0,k.Jn)(e[t]),alt:n.title,className:"w-full h-full object-cover",onError:k.Mp,loading:"lazy"}),e.length>1&&(0,s.jsx)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2",children:e.map((e,t)=>(0,s.jsx)("button",{onClick:()=>v(t),className:"w-2 h-2 rounded-full ".concat(t===h?"bg-white":"bg-white/50")},t))})]})})}return(0,s.jsx)("div",{className:"mb-6 h-96 bg-gray-200 rounded-lg flex items-center justify-center text-gray-400",children:"No Images Available"})})(),(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[n.is_verified&&(0,s.jsxs)("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm flex items-center gap-1",children:[(0,s.jsx)(m.Z,{size:14}),"Verified Property"]}),n.is_featured&&(0,s.jsx)("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:"Featured"}),n.is_urgent_sale&&(0,s.jsx)("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm",children:"Urgent Sale"}),n.has_title_deed&&(0,s.jsx)("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm",children:"Title Deed Available"})]}),(0,s.jsxs)("div",{className:"flex items-center text-gray-600 mb-4",children:[(0,s.jsx)(u.Z,{size:18,className:"mr-2"}),(0,s.jsxs)("span",{className:"text-lg",children:[n.area?"".concat(n.area,", "):"",n.district]})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-gray-900 mb-6",children:(t=n.price,"MWK"===(l=n.currency)?"MWK ".concat(t.toLocaleString()):"".concat(l," ").concat(t.toLocaleString()))}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[n.bedrooms>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-700",children:[(0,s.jsx)(g.Z,{size:20}),(0,s.jsxs)("span",{children:[n.bedrooms," Bedrooms"]})]}),n.bathrooms>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-700",children:[(0,s.jsx)(p.Z,{size:20}),(0,s.jsxs)("span",{children:[n.bathrooms," Bathrooms"]})]}),n.plot_size&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-700",children:[(0,s.jsx)(x.Z,{size:20}),(0,s.jsxs)("span",{children:[n.plot_size.toLocaleString(),"m\xb2"]})]}),n.documentation_type&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-700",children:[(0,s.jsx)(y,{size:20}),(0,s.jsx)("span",{children:n.documentation_type})]})]}),n.description&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Description"}),(0,s.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.description})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-6",children:[(0,s.jsx)(b.Z,{size:16}),(0,s.jsxs)("span",{children:["Listed on ",new Date(n.listed_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("button",{onClick:c,className:"w-full bg-blue-600 text-white py-3.5 sm:py-4 rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors font-semibold text-base sm:text-lg shadow-lg hover:shadow-xl min-h-[44px]",children:"Send Inquiry"}),(0,s.jsx)("p",{className:"text-center text-sm text-blue-600 font-medium mt-2",children:"✨ Get priority response from agent/owner"})]}),(j||N)&&!z&&(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,s.jsx)("p",{className:"text-center text-sm text-gray-600 mb-3",children:"Or contact the seller directly"}),(0,s.jsxs)("div",{className:"space-y-2",children:[j&&(0,s.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:["Agent: ",j.full_name||"Agent"]}),j.phone&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsxs)("a",{href:"https://wa.me/".concat(j.phone.replace(/[^0-9]/g,"")),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-green-600 hover:text-green-700 font-medium",children:[(0,s.jsx)(f,{size:16}),"WhatsApp"]}),(0,s.jsx)("span",{className:"text-gray-300",children:"•"}),(0,s.jsxs)("a",{href:"tel:".concat(j.phone),className:"flex items-center gap-2 text-gray-700 hover:text-blue-600",children:[(0,s.jsx)(f,{size:16}),j.phone]})]})]}),N&&!j&&(0,s.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:["Owner: ",N.full_name||"Owner"]}),N.phone&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsxs)("a",{href:"https://wa.me/".concat(N.phone.replace(/[^0-9]/g,"")),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-green-600 hover:text-green-700 font-medium",children:[(0,s.jsx)(f,{size:16}),"WhatsApp"]}),(0,s.jsx)("span",{className:"text-gray-300",children:"•"}),(0,s.jsxs)("a",{href:"tel:".concat(N.phone),className:"flex items-center gap-2 text-gray-700 hover:text-blue-600",children:[(0,s.jsx)(f,{size:16}),N.phone]})]})]})]}),(0,s.jsx)("p",{className:"text-center text-xs text-gray-500 mt-3",children:"All transactions happen off-platform"})]})]})]})}):(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 sm:p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg sm:rounded-xl max-w-2xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-3 sm:p-4 flex items-center justify-between z-10",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 pr-2 truncate",children:n.title}),(0,s.jsx)("button",{onClick:o,className:"p-2 hover:bg-gray-100 rounded-full transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center flex-shrink-0","aria-label":"Close",children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsxs)("div",{className:"p-6",children:[(()=>{let e=(0,k.DQ)(n.images);return e.length>0?(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)("img",{src:(0,k.Jn)(e[0]),alt:n.title,className:"w-full h-64 object-cover rounded-lg",onError:k.Mp,loading:"lazy"})}):null})(),(0,s.jsxs)("div",{className:"flex items-center text-gray-600 mb-4",children:[(0,s.jsx)(u.Z,{size:18,className:"mr-2"}),(0,s.jsxs)("span",{className:"text-lg",children:[n.area?"".concat(n.area,", "):"",n.district]})]}),(0,s.jsxs)("div",{className:"text-3xl font-bold text-gray-900 mb-6",children:[n.currency," ",n.price.toLocaleString()]}),n.plot_size&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-700 mb-4",children:[(0,s.jsx)(x.Z,{size:20}),(0,s.jsxs)("span",{children:[n.plot_size.toLocaleString(),"m\xb2"]})]}),(0,s.jsxs)("div",{className:"mt-8 p-6 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Want to see full property details?"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Fill in a quick form to unlock complete property information and seller contact details."}),(0,s.jsx)("button",{onClick:()=>{Z(!0)},className:"w-full bg-blue-600 text-white py-3.5 sm:py-3 rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors font-semibold text-base min-h-[44px]",children:"View Full Details"})]})]})]})})}function z(e){let{property:t,onClose:r,onSuccess:l}=e,[n,o]=(0,a.useState)({buyer_name:"",buyer_country:"",buyer_city:"",buyer_location:"",buyer_origin_type:"",local_origin_city:"",budget_range:"",intended_use:"",payment_method_preference:"",message:""}),[c,u]=(0,a.useState)(!1),[x,m]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{let{data:{user:e}}=await i.supabase.auth.getUser();if(e){let{data:t}=await i.supabase.from("profiles").select("full_name, current_location").eq("id",e.id).maybeSingle();if(t){if(t.current_location){let e=t.current_location.split(",").map(e=>e.trim());o(r=>({...r,buyer_name:t.full_name||"",buyer_location:t.current_location||"",buyer_city:e[0]||"",buyer_country:e[1]||e[0]||""}))}else o(e=>({...e,buyer_name:t.full_name||""}))}}})()},[]);let g=async e=>{e.preventDefault(),u(!0),m("");try{var r;let{data:{user:e}}=await i.supabase.auth.getUser();if(!e){m("Please sign in to send an inquiry"),u(!1);return}let s=n.buyer_origin_type||((null===(r=n.buyer_country)||void 0===r?void 0:r.toLowerCase())==="malawi"?"local":"diaspora"),a=n.buyer_city&&n.buyer_country?"".concat(n.buyer_city,", ").concat(n.buyer_country):n.buyer_location,{error:o}=await i.supabase.from("inquiries").insert({property_id:t.id,buyer_id:e.id,buyer_name:n.buyer_name,buyer_country:n.buyer_country,buyer_city:n.buyer_city,buyer_location:a,buyer_origin_type:s,local_origin_city:"local"===s?n.local_origin_city:null,budget_range:n.budget_range,intended_use:n.intended_use,payment_method_preference:n.payment_method_preference,message:n.message});if(o)throw o;await i.supabase.from("properties").update({inquiries_count:t.inquiries_count+1}).eq("id",t.id),l()}catch(e){m("Failed to send inquiry. Please try again."),console.error(e)}finally{u(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Send Inquiry"}),(0,s.jsx)("p",{className:"text-sm text-blue-600 font-medium mt-1",children:"✨ Get priority response from agent/owner"})]}),(0,s.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(d.Z,{size:24})})]}),(0,s.jsxs)("form",{onSubmit:g,className:"p-6",children:[(0,s.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg mb-1",children:t.title}),(0,s.jsxs)("p",{className:"text-gray-600 text-sm",children:[t.district," • ",t.currency," ",t.price.toLocaleString()]})]}),x&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-100 text-red-700 rounded-lg",children:x}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.buyer_name,onChange:e=>o({...n,buyer_name:e.target.value}),placeholder:"e.g., John Mwale",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Are you living in Malawi or outside? *"}),(0,s.jsxs)("select",{required:!0,value:n.buyer_origin_type,onChange:e=>{let t=e.target.value;o({...n,buyer_origin_type:t,buyer_country:"local"===t?"Malawi":n.buyer_country,local_origin_city:"local"===t?n.local_origin_city:""})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select..."}),(0,s.jsx)("option",{value:"diaspora",children:"Diaspora (Living outside Malawi)"}),(0,s.jsx)("option",{value:"local",children:"Local (Living in Malawi)"})]})]}),"local"===n.buyer_origin_type?(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Which city in Malawi are you from? *"}),(0,s.jsxs)("select",{required:!0,value:n.local_origin_city,onChange:e=>o({...n,local_origin_city:e.target.value,buyer_city:e.target.value,buyer_country:"Malawi"}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select your city"}),["Lilongwe","Blantyre","Mzuzu","Zomba","Kasungu","Mangochi","Karonga","Salima","Nkhotakota","Liwonde","Nsanje","Mchinji","Dedza","Dowa","Ntcheu","Balaka","Mulanje","Thyolo","Other"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}):"diaspora"===n.buyer_origin_type?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.buyer_country,onChange:e=>o({...n,buyer_country:e.target.value}),placeholder:"e.g., South Africa, UK, USA",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),(0,s.jsx)("input",{type:"text",required:!0,value:n.buyer_city,onChange:e=>o({...n,buyer_city:e.target.value}),placeholder:"e.g., Johannesburg, London",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}):null,(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Current Location (optional)"}),(0,s.jsx)("input",{type:"text",value:n.buyer_location,onChange:e=>o({...n,buyer_location:e.target.value}),placeholder:"e.g., Johannesburg, South Africa",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"This field is optional. Country and City above are preferred."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget Range"}),(0,s.jsx)("input",{type:"text",value:n.budget_range,onChange:e=>o({...n,budget_range:e.target.value}),placeholder:"e.g., $50,000 - $75,000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Intended Use"}),(0,s.jsxs)("select",{value:n.intended_use,onChange:e=>o({...n,intended_use:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select intended use"}),(0,s.jsx)("option",{value:"Home Build",children:"Home Build"}),(0,s.jsx)("option",{value:"Rental Income",children:"Rental Income"}),(0,s.jsx)("option",{value:"Farming",children:"Farming"}),(0,s.jsx)("option",{value:"Commercial",children:"Commercial"}),(0,s.jsx)("option",{value:"Investment",children:"Investment"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method Preference"}),(0,s.jsxs)("select",{value:n.payment_method_preference,onChange:e=>o({...n,payment_method_preference:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select payment method"}),(0,s.jsx)("option",{value:"Bank Transfer",children:"Bank Transfer"}),(0,s.jsx)("option",{value:"Cash",children:"Cash"}),(0,s.jsx)("option",{value:"Installments",children:"Installments"}),(0,s.jsx)("option",{value:"Mortgage",children:"Mortgage"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,s.jsx)("textarea",{value:n.message,onChange:e=>o({...n,message:e.target.value}),placeholder:"Tell us more about your interest...",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"flex-1 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Sending...":"Send Inquiry"})]})]})]})})}var M=r(4232),S=r(1240),Z=r(500);function P(e){let{onSearch:t,districts:r}=e,[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[m,g]=(0,a.useState)({totalProperties:0,totalBuyers:0,verifiedAgents:0});(0,a.useEffect)(()=>{p()},[]);let p=async()=>{try{let{data:e}=await i.supabase.from("properties").select("id").eq("status","available"),{data:t}=await i.supabase.from("profiles").select("id").eq("user_type","buyer"),{data:r}=await i.supabase.from("agents").select("id").eq("verification_status","verified");g({totalProperties:(null==e?void 0:e.length)||0,totalBuyers:(null==t?void 0:t.length)||0,verifiedAgents:(null==r?void 0:r.length)||0})}catch(e){console.error("Error loading stats:",e)}};return(0,s.jsxs)("div",{className:"relative bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800 text-white overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,s.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}})}),(0,s.jsx)("div",{className:"relative container mx-auto px-4 py-20 md:py-28",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,s.jsxs)("h1",{className:"text-4xl md:text-6xl font-bold mb-6 leading-tight",children:["Find Your Dream Property",(0,s.jsx)("span",{className:"block text-blue-200",children:"in Malawi"})]}),(0,s.jsx)("p",{className:"text-xl md:text-2xl text-blue-100 mb-8 max-w-2xl mx-auto",children:"Trusted by thousands of Malawian diaspora buyers worldwide. Verified properties, trusted agents, direct contact. Free for all."}),(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),t&&t(l)},className:"bg-white rounded-2xl shadow-2xl p-2 md:p-4 mb-12",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(n.Z,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"Search properties, districts, or areas...",className:"w-full pl-12 pr-4 py-3 md:py-4 text-gray-900 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-lg"})]}),(0,s.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"px-4 py-3 md:py-4 text-gray-900 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none border border-gray-300 text-lg",children:[(0,s.jsx)("option",{value:"",children:"All Types"}),(0,s.jsx)("option",{value:"land",children:"Land"}),(0,s.jsx)("option",{value:"house",children:"House"}),(0,s.jsx)("option",{value:"rental",children:"Rental"}),(0,s.jsx)("option",{value:"commercial",children:"Commercial"}),(0,s.jsx)("option",{value:"mixed",children:"Mixed Use"})]}),(0,s.jsxs)("select",{value:u,onChange:e=>x(e.target.value),className:"px-4 py-3 md:py-4 text-gray-900 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none border border-gray-300 text-lg",children:[(0,s.jsx)("option",{value:"",children:"All Districts"}),r.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsx)("button",{type:"submit",className:"px-8 py-3 md:py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold text-lg transition-colors shadow-lg",children:"Search"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 max-w-3xl mx-auto",children:[(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[(0,s.jsx)(M.Z,{className:"mx-auto mb-3",size:32}),(0,s.jsx)("div",{className:"text-3xl md:text-4xl font-bold mb-1",children:m.totalProperties>0?m.totalProperties.toLocaleString():"500+"}),(0,s.jsx)("div",{className:"text-blue-200 text-sm md:text-base",children:"Verified Properties"})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[(0,s.jsx)(S.Z,{className:"mx-auto mb-3",size:32}),(0,s.jsx)("div",{className:"text-3xl md:text-4xl font-bold mb-1",children:m.totalBuyers>0?m.totalBuyers.toLocaleString():"10K+"}),(0,s.jsx)("div",{className:"text-blue-200 text-sm md:text-base",children:"Diaspora Buyers"})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[(0,s.jsx)(Z.Z,{className:"mx-auto mb-3",size:32}),(0,s.jsx)("div",{className:"text-3xl md:text-4xl font-bold mb-1",children:m.verifiedAgents>0?m.verifiedAgents:"50+"}),(0,s.jsx)("div",{className:"text-blue-200 text-sm md:text-base",children:"Trusted Agents"})]})]})]})}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0",children:(0,s.jsx)("svg",{className:"w-full h-16 fill-gray-50",viewBox:"0 0 1440 120",preserveAspectRatio:"none",children:(0,s.jsx)("path",{d:"M0,64L80,69.3C160,75,320,85,480,80C640,75,800,53,960,48C1120,43,1280,53,1360,58.7L1440,64L1440,120L1360,120C1280,120,1120,120,960,120C800,120,640,120,480,120C320,120,160,120,80,120L0,120Z"})})})]})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let L=(0,h.Z)("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),q=(0,h.Z)("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);var A=r(7138);let D=[{id:"land",name:"Land",icon:(0,s.jsx)(u.Z,{size:32}),description:"Plots and vacant land",color:"text-green-600",bgColor:"bg-green-50 hover:bg-green-100"},{id:"house",name:"Houses",icon:(0,s.jsx)(w,{size:32}),description:"Residential homes",color:"text-blue-600",bgColor:"bg-blue-50 hover:bg-blue-100"},{id:"commercial",name:"Commercial",icon:(0,s.jsx)(L,{size:32}),description:"Business properties",color:"text-purple-600",bgColor:"bg-purple-50 hover:bg-purple-100"},{id:"rental",name:"Rentals",icon:(0,s.jsx)(M.Z,{size:32}),description:"Houses for rent",color:"text-orange-600",bgColor:"bg-orange-50 hover:bg-orange-100"},{id:"mixed",name:"Mixed Use",icon:(0,s.jsx)(q,{size:32}),description:"Multi-purpose properties",color:"text-indigo-600",bgColor:"bg-indigo-50 hover:bg-indigo-100"}];function T(){return(0,s.jsx)("div",{className:"bg-white py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Browse by Category"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Find the perfect property type for your needs"})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 md:gap-6",children:D.map(e=>(0,s.jsxs)(A.default,{href:"/?propertyType=".concat(e.id),className:"".concat(e.bgColor," rounded-xl p-6 text-center transition-all duration-300 transform hover:scale-105 hover:shadow-lg border border-gray-100"),children:[(0,s.jsx)("div",{className:"".concat(e.color," mb-3 flex justify-center"),children:e.icon}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},e.id))})]})})}var E=r(3225);function B(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{n()},[]);let n=async()=>{try{let{data:e}=await i.supabase.from("properties").select("district").eq("status","available"),r=null==e?void 0:e.reduce((e,t)=>(e[t.district]=(e[t.district]||0)+1,e),{}),s=Object.entries(r||{}).map(e=>{let[t,r]=e;return{district:t,count:r}}).sort((e,t)=>t.count-e.count).slice(0,6);0===s.length?t([{district:"Lilongwe",count:0},{district:"Blantyre",count:0},{district:"Mzuzu",count:0},{district:"Zomba",count:0},{district:"Mangochi",count:0},{district:"Kasungu",count:0}]):t(s)}catch(e){console.error("Error loading districts:",e)}finally{l(!1)}};return r?null:(0,s.jsx)("div",{className:"bg-gray-50 py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsxs)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4 flex items-center justify-center gap-3",children:[(0,s.jsx)(u.Z,{className:"text-blue-600",size:32}),"Popular Districts"]}),(0,s.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Discover the most sought-after locations in Malawi"})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:e.map(e=>(0,s.jsxs)(A.default,{href:"/?district=".concat(encodeURIComponent(e.district)),className:"bg-white rounded-xl p-6 hover:shadow-lg transition-all duration-300 transform hover:scale-105 border border-gray-200 group",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)(u.Z,{className:"text-blue-600 group-hover:text-blue-700",size:24}),e.count>0&&(0,s.jsxs)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-semibold flex items-center gap-1",children:[(0,s.jsx)(E.Z,{size:12}),e.count]})]}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:e.district}),e.count>0&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.count," properties"]})]},e.district))})]})})}var U=r(7390),H=r(5862);let I=[{number:"01",title:"Browse Properties",description:"Explore verified listings across all districts in Malawi. Filter by type, price, and location.",icon:(0,s.jsx)(n.Z,{size:32})},{number:"02",title:"Contact Owner",description:"Found a property you like? Contact the agent or property owner directly using the provided contact details.",icon:(0,s.jsx)(U.Z,{size:32})},{number:"03",title:"Complete Off-Platform",description:"Connect with trusted agents, verify documentation, and complete your purchase directly. All transactions happen off-platform.",icon:(0,s.jsx)(Z.Z,{size:32})}];function V(){return(0,s.jsx)("div",{className:"bg-white py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"How It Works"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Free listings, direct contact, trusted agents. Designed for the diaspora community."})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-12 max-w-5xl mx-auto",children:I.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[t<I.length-1&&(0,s.jsx)("div",{className:"hidden md:block absolute top-16 left-full w-full h-0.5 bg-gradient-to-r from-blue-200 to-transparent z-0",style:{width:"calc(100% - 4rem)"}}),(0,s.jsxs)("div",{className:"relative bg-white rounded-2xl p-8 border-2 border-gray-100 hover:border-blue-500 transition-all duration-300 hover:shadow-xl group",children:[(0,s.jsx)("div",{className:"absolute -top-6 -left-6 bg-blue-600 text-white rounded-full w-12 h-12 flex items-center justify-center font-bold text-lg shadow-lg group-hover:bg-blue-700 transition-colors",children:e.number}),(0,s.jsx)("div",{className:"text-blue-600 mb-6 group-hover:scale-110 transition-transform",children:e.icon}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:e.title}),(0,s.jsx)("p",{className:"text-gray-600 leading-relaxed",children:e.description}),(0,s.jsx)("div",{className:"absolute -bottom-4 -right-4 text-blue-100 opacity-50 group-hover:opacity-75 transition-opacity",children:(0,s.jsx)(H.Z,{size:64})})]})]},e.number))})]})})}var F=r(4453),R=r(4436),O=r(8281);let W=[{icon:(0,s.jsx)(Z.Z,{size:24}),title:"Verified Listings",description:"All properties are verified for authenticity and documentation"},{icon:(0,s.jsx)(S.Z,{size:24}),title:"Trusted Agents",description:"Work with verified, licensed real estate agents"},{icon:(0,s.jsx)(F.Z,{size:24}),title:"Free & Direct",description:"Free listings for all. Contact owners directly. No commissions or fees."},{icon:(0,s.jsx)(R.Z,{size:24}),title:"Diaspora Focus",description:"Designed specifically for the Malawian diaspora community"},{icon:(0,s.jsx)(O.Z,{size:24}),title:"Quality Assured",description:"We maintain high standards for all listed properties"},{icon:(0,s.jsx)(H.Z,{size:24}),title:"Documentation Verified",description:"Title deeds and legal documents are verified before listing"}];function K(){return(0,s.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Why Trust Us?"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Built for the diaspora community. Free listings, verified data, direct connections."})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl mx-auto",children:W.map((e,t)=>(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 hover:shadow-lg transition-all duration-300 border border-gray-200 group",children:[(0,s.jsx)("div",{className:"text-blue-600 mb-4 group-hover:scale-110 transition-transform inline-block",children:e.icon}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},t))})]})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let J=(0,h.Z)("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]);var Y=r(9338);let G=[{name:"Sarah Mwale",location:"South Africa",role:"Property Buyer",content:"Found my perfect plot in Lilongwe through this platform. The verification process gave me confidence, and the agent was very professional. Highly recommend!",rating:5},{name:"James Phiri",location:"United Kingdom",role:"Diaspora Investor",content:"As someone living abroad, it was challenging to find reliable property listings. This platform made it so easy, and I was able to secure a great investment property.",rating:5},{name:"Grace Banda",location:"United States",role:"First-time Buyer",content:"The detailed property information and verified documentation made buying property from abroad stress-free. The agents are trustworthy and responsive.",rating:5}];function Q(){return(0,s.jsx)("div",{className:"bg-white py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"What Our Buyers Say"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Real experiences from the Malawian diaspora community"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:G.map((e,t)=>(0,s.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-8 border border-gray-200 hover:shadow-lg transition-all duration-300 relative",children:[(0,s.jsx)("div",{className:"absolute top-6 right-6 text-blue-100",children:(0,s.jsx)(J,{size:48})}),(0,s.jsx)("div",{className:"flex gap-1 mb-4",children:[...Array(e.rating)].map((e,t)=>(0,s.jsx)(Y.Z,{className:"text-yellow-400 fill-yellow-400",size:20},t))}),(0,s.jsxs)("p",{className:"text-gray-700 mb-6 leading-relaxed relative z-10",children:['"',e.content,'"']}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,s.jsx)("div",{className:"font-semibold text-gray-900 mb-1",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(u.Z,{size:14}),(0,s.jsx)("span",{children:e.location})]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:e.role})]})]},t))})]})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let $=(0,h.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var X=r(2513);function ee(){return(0,s.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-blue-800 py-16 text-white relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,s.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}})}),(0,s.jsx)("div",{className:"relative container mx-auto px-4",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,s.jsx)("h2",{className:"text-3xl md:text-5xl font-bold mb-6",children:"Ready to Find Your Property?"}),(0,s.jsx)("p",{className:"text-xl md:text-2xl text-blue-100 mb-10 max-w-2xl mx-auto",children:"Join thousands of Malawian diaspora buyers who trust us for their property search"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,s.jsxs)(A.default,{href:"/",className:"bg-white text-blue-600 px-8 py-4 rounded-xl font-semibold text-lg hover:bg-blue-50 transition-all duration-300 flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,s.jsx)(n.Z,{size:24}),"Browse Properties",(0,s.jsx)($,{size:20})]}),(0,s.jsxs)(A.default,{href:"/dashboard",className:"bg-blue-800 text-white px-8 py-4 rounded-xl font-semibold text-lg hover:bg-blue-900 transition-all duration-300 flex items-center justify-center gap-2 border-2 border-white/20 hover:border-white/40 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,s.jsx)(X.Z,{size:24}),"List Your Property",(0,s.jsx)($,{size:20})]})]}),(0,s.jsx)("p",{className:"text-blue-200 text-sm mt-8",children:"Free to browse • Verified properties • Trusted agents"})]})})]})}function et(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)([]),[d,u]=(0,a.useState)([]),[x,m]=(0,a.useState)(!0),[g,p]=(0,a.useState)(null),[h,y]=(0,a.useState)(!1),[b,f]=(0,a.useState)({search:"",propertyType:"",district:"",minPrice:"",maxPrice:"",currency:""});(0,a.useEffect)(()=>{(0,o.getOrCreateSession)(),v()},[]),(0,a.useEffect)(()=>{j()},[e,b]);let v=async()=>{try{let{data:e,error:r}=await i.supabase.from("properties").select("*").eq("status","available").order("is_featured",{ascending:!1}).order("listed_at",{ascending:!1});if(r)throw console.error("❌ Error fetching properties:",r),r;t(e||[]);let s=[...new Set((null==e?void 0:e.map(e=>e.district))||[])];u(s.sort())}catch(e){console.error("❌ Error loading properties:",e)}finally{m(!1)}},j=()=>{let t=[...e];if(b.search){let e=b.search.toLowerCase();t=t.filter(t=>{var r,s;return t.title.toLowerCase().includes(e)||(null===(r=t.description)||void 0===r?void 0:r.toLowerCase().includes(e))||t.district.toLowerCase().includes(e)||(null===(s=t.area)||void 0===s?void 0:s.toLowerCase().includes(e))})}b.propertyType&&(t=t.filter(e=>e.property_type===b.propertyType)),b.district&&(t=t.filter(e=>e.district===b.district)),b.currency&&(t=t.filter(e=>e.currency===b.currency)),b.minPrice&&(t=t.filter(e=>e.price>=Number(b.minPrice))),b.maxPrice&&(t=t.filter(e=>e.price<=Number(b.maxPrice))),n(t)},w=e=>{p(e)};return x?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("div",{className:"text-xl text-gray-600",children:"Loading properties..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(P,{onSearch:e=>{f(t=>({...t,search:e}));let t=document.getElementById("properties-section");t&&t.scrollIntoView({behavior:"smooth"})},districts:d}),(0,s.jsx)(T,{}),(0,s.jsx)(B,{}),(0,s.jsx)(V,{}),(0,s.jsx)(K,{}),(0,s.jsx)("div",{id:"properties-section",className:"bg-gray-50 py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Available Properties"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Discover verified properties across Malawi"})]}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6 mb-8",children:(0,s.jsx)(c,{filters:b,onChange:f,districts:d,resultsCount:r.length})}),(0,s.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,s.jsxs)("div",{className:"text-gray-700 font-medium",children:["Showing ",(0,s.jsx)("span",{className:"text-blue-600 font-bold",children:r.length})," of"," ",(0,s.jsx)("span",{className:"text-gray-900 font-bold",children:e.length})," properties"]})}),0===r.length?(0,s.jsx)("div",{className:"text-center py-16 bg-white rounded-xl shadow-md",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD0D"}),(0,s.jsx)("p",{className:"text-xl text-gray-900 font-semibold mb-2",children:"No properties found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Try adjusting your filters or search criteria"}),(0,s.jsx)("button",{onClick:()=>f({search:"",propertyType:"",district:"",minPrice:"",maxPrice:"",currency:""}),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Clear All Filters"})]})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8",children:r.map(e=>(0,s.jsx)(l.J,{property:e,onClick:()=>w(e)},e.id))})]})}),(0,s.jsx)(Q,{}),(0,s.jsx)(ee,{}),g&&(0,s.jsx)(C,{property:g,onClose:()=>p(null),onInquire:()=>{y(!0)}}),h&&g&&(0,s.jsx)(z,{property:g,onClose:()=>y(!1),onSuccess:()=>{y(!1),p(null),alert("Your inquiry has been sent successfully!")}})]})}}},function(e){e.O(0,[432,317,171,971,23,744],function(){return e(e.s=1347)}),_N_E=e.O()}]);