(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{10:function(e,r,s){Promise.resolve().then(s.bind(s,9508))},9508:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return d}});var t=s(7437),n=s(2265),a=s(6463),o=s(4316),i=s(500),l=s(7515);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s(1066).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var u=s(4453);function d(){let[e,r]=(0,n.useState)(""),[s,d]=(0,n.useState)(""),[m,h]=(0,n.useState)(!1),[p,g]=(0,n.useState)(""),[f,x]=(0,n.useState)(!1),[D,b]=(0,n.useState)(!1),[y,w]=(0,n.useState)(!1),C=(0,a.useRouter)(),N=async r=>{r.preventDefault(),console.warn("\uD83D\uDE80\uD83D\uDE80\uD83D\uDE80 LOGIN STARTED \uD83D\uDE80\uD83D\uDE80\uD83D\uDE80"),console.warn("\uD83D\uDCE7 Email:",e),console.warn("\uD83D\uDD11 Password length:",s.length),console.error("\uD83D\uDD0D DEBUG: Form submitted, handleLogin called!"),h(!0),g(""),x(!1);try{var t,n;console.warn("\uD83D\uDCCB STEP 1: Checking environment variables...");let r="https://ofuyghemecqstflnhixy.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mdXlnaGVtZWNxc3RmbG5oaXh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMDQ0NzUsImV4cCI6MjA3ODg4MDQ3NX0.kD12l4KnDFZuRNFCSOEIQWKCGdvy8CBCnuL2ukC0TAc";if(console.warn("\uD83D\uDD0D Environment Check:",{url:r?"".concat(r.substring(0,30),"..."):"MISSING",key:a?"".concat(a.substring(0,20),"..."):"MISSING",keyLength:a.length||0}),!r||!a){let e="Missing environment variables. URL: ".concat(r?"✓":"✗",", Key: ").concat(a?"✓":"✗",". Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in Vercel environment variables and redeploy.");throw console.error("❌",e),Error(e)}console.warn("\uD83D\uDCCB STEP 2: Testing Supabase connection...");try{let e="".concat(r,"/rest/v1/");console.warn("\uD83E\uDDEA Testing Supabase connection to:",e);let s=await fetch(e,{method:"HEAD",headers:{apikey:a}});console.warn("✅ Supabase connection test:",s.status,s.statusText)}catch(e){throw console.error("❌ Supabase connection test failed:",e),Error("Cannot connect to Supabase. Check URL: ".concat(r,". Error: ").concat(e.message))}console.warn("\uD83D\uDCCB STEP 3: Attempting authentication..."),console.warn("\uD83D\uDD10 Signing in with email:",e),console.error("⏳ CALLING supabase.auth.signInWithPassword NOW...");let{data:i,error:l}=await o.supabase.auth.signInWithPassword({email:e,password:s});if(console.error("\uD83D\uDCE6 Auth response received:",{hasData:!!i,hasUser:!!(null==i?void 0:i.user),hasError:!!l,userId:null==i?void 0:null===(t=i.user)||void 0===t?void 0:t.id,userEmail:null==i?void 0:null===(n=i.user)||void 0===n?void 0:n.email}),l){if(console.error("❌ Auth error occurred:",{message:l.message,status:l.status,error:l}),l.message.includes("Invalid login credentials"))throw Error("Invalid email or password. Please check your credentials.");if(l.message.includes("Email not confirmed"))throw Error("Please confirm your email address first.");if(l.message.includes("Failed to fetch"))throw Error("Connection failed. Please check your internet connection and Supabase URL.");throw l}if(!i||!i.user)throw console.error("❌ No user data in auth response:",i),Error("Login failed. Please check your credentials.");console.error("✅✅✅ STEP 3 SUCCESS: Authentication successful ✅✅✅"),console.warn("\uD83D\uDC64 User authenticated:",{id:i.user.id,email:i.user.email,createdAt:i.user.created_at}),console.warn("\uD83D\uDCCB STEP 4: Checking user profile and admin status..."),console.warn("\uD83D\uDD0D Querying profiles table for user ID:",i.user.id);let{data:c,error:u}=await o.supabase.from("profiles").select("id, email, user_type, is_verified").eq("id",i.user.id).maybeSingle();if(console.error("\uD83D\uDCE6 Profile query response:",{hasData:!!c,hasError:!!u,profile:c,error:u}),u)throw console.error("❌ Profile query error:",{message:u.message,details:u,code:u.code,hint:u.hint}),console.error("Error details (JSON):",JSON.stringify(u,null,2)),Error("Failed to check user permissions: ".concat(u.message,". Make sure the profile exists in Supabase."));if(!c)throw console.error("❌ No profile found for user:",{userId:i.user.id,userEmail:i.user.email}),console.log("\uD83D\uDD13 Signing out user due to missing profile..."),await o.supabase.auth.signOut(),Error("User profile not found. Please create the admin profile in Supabase first. See CREATE_ADMIN_NOW.md");if(console.error("✅ STEP 4 SUCCESS: Profile found"),console.warn("\uD83D\uDC64 Profile details:",{id:c.id,email:c.email,user_type:c.user_type,is_verified:c.is_verified}),"admin"!==c.user_type)throw console.error("❌❌❌ User is not admin:",{required:"admin",actual:c.user_type}),console.warn("\uD83D\uDD13 Signing out user due to insufficient privileges..."),await o.supabase.auth.signOut(),Error("Access denied. Admin privileges required. Current user type: ".concat(c.user_type,". Update profile in Supabase."));console.error("✅✅✅ STEP 4 SUCCESS: User is admin ✅✅✅"),console.warn("\uD83D\uDCCB STEP 5: Redirecting to admin dashboard..."),x(!0),console.error('\uD83D\uDD04\uD83D\uDD04\uD83D\uDD04 Calling router.push("/admin")...');try{C.push("/admin"),console.error("✅ router.push() called successfully"),console.warn("\uD83D\uDD04 Calling router.refresh()..."),C.refresh(),console.error("✅ router.refresh() called successfully"),console.warn("⏳ Waiting 2 seconds to check if redirect worked..."),await new Promise(e=>setTimeout(e,2e3)),console.error("\uD83D\uDCCD\uD83D\uDCCD\uD83D\uDCCD Current location after redirect attempt:",window.location.href)}catch(e){throw console.error("❌❌❌ Redirect error:",e),Error("Redirect failed: ".concat(e.message))}console.error("✅✅✅ LOGIN COMPLETE - All steps successful ✅✅✅")}catch(e){console.error("❌ LOGIN FAILED - Error caught:",e),console.error("Error details:",{message:e.message,stack:e.stack,name:e.name,error:e}),g(e.message||e.error_description||"Login failed. Please try again."),console.error("Full error object:",e)}finally{console.error("\uD83C\uDFC1\uD83C\uDFC1\uD83C\uDFC1 Login process finished, setting loading to false \uD83C\uDFC1\uD83C\uDFC1\uD83C\uDFC1"),h(!1)}},v=async r=>{r.preventDefault(),h(!0),g("");try{if(!e){g("Please enter your email address"),h(!1);return}let{error:r}=await o.supabase.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/admin/reset-password")});if(r)throw r;w(!0)}catch(e){g(e.message||"Failed to send password reset email")}finally{h(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-md w-full",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-600 rounded-2xl mb-4 shadow-lg",children:(0,t.jsx)(i.Z,{className:"text-white",size:32})}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Login"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Access the admin dashboard"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-200",children:[f&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-green-900",children:"✅ Login Successful!"}),(0,t.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"Redirecting to admin dashboard..."})]})}),p&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[(0,t.jsx)(l.Z,{className:"text-red-600 flex-shrink-0 mt-0.5",size:20}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-red-900",children:"Error"}),(0,t.jsx)("p",{className:"text-sm text-red-700 mt-1",children:p}),(0,t.jsx)("p",{className:"text-xs text-red-600 mt-2",children:"Check browser console (F12) for detailed logs."})]})]}),(0,t.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(c,{className:"text-gray-400",size:20})}),(0,t.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>r(e.target.value),required:!0,className:"block w-full pl-10 pr-3 py-3.5 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-gray-900 placeholder-gray-400 text-base min-h-[44px]",placeholder:"admin@example.com",autoComplete:"email"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),!D&&(0,t.jsx)("button",{type:"button",onClick:()=>b(!0),className:"text-sm text-red-600 hover:underline",children:"Forgot password?"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(u.Z,{className:"text-gray-400",size:20})}),(0,t.jsx)("input",{id:"password",type:"password",value:s,onChange:e=>d(e.target.value),required:!D,disabled:D,className:"block w-full pl-10 pr-3 py-3.5 sm:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent text-gray-900 placeholder-gray-400 text-base min-h-[44px] disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"••••••••",autoComplete:"current-password"})]})]}),D?(0,t.jsx)(t.Fragment,{children:y?(0,t.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-green-800 font-medium mb-2",children:"✅ Password reset email sent!"}),(0,t.jsxs)("p",{className:"text-sm text-green-700",children:["Check your email (",e,") for a password reset link. Click the link to reset your password."]}),(0,t.jsx)("button",{type:"button",onClick:()=>{b(!1),w(!1)},className:"mt-4 text-sm text-red-600 hover:underline",children:"Back to Login"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{type:"button",onClick:v,disabled:m||!e,className:"w-full bg-red-600 text-white py-3.5 sm:py-3 px-4 rounded-lg font-semibold hover:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-base min-h-[44px]",children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Sending..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c,{size:20}),(0,t.jsx)("span",{children:"Send Reset Link"})]})}),(0,t.jsx)("button",{type:"button",onClick:()=>b(!1),className:"w-full mt-3 border border-gray-300 text-gray-700 py-3.5 sm:py-3 px-4 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"Cancel"})]})}):(0,t.jsx)("button",{type:"submit",disabled:m,className:"w-full bg-red-600 text-white py-3.5 sm:py-3 px-4 rounded-lg font-semibold hover:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-base min-h-[44px]",children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Logging in..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Z,{size:20}),(0,t.jsx)("span",{children:"Login"})]})})]}),(0,t.jsx)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-xs text-blue-800",children:[(0,t.jsx)("strong",{children:"Note:"})," Only users with admin privileges can access this page. If you need admin access, contact your system administrator."]})})]}),(0,t.jsx)("div",{className:"text-center mt-6",children:(0,t.jsx)("a",{href:"/",className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:"← Back to Marketplace"})})]})})}},7515:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(1066).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},4453:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(1066).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},500:function(e,r,s){"use strict";s.d(r,{Z:function(){return t}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(1066).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},6463:function(e,r,s){"use strict";var t=s(1169);s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})},4316:function(e,r,s){"use strict";s.d(r,{supabase:function(){return i}});var t=s(6887);let n="https://ofuyghemecqstflnhixy.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9mdXlnaGVtZWNxc3RmbG5oaXh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzMDQ0NzUsImV4cCI6MjA3ODg4MDQ3NX0.kD12l4KnDFZuRNFCSOEIQWKCGdvy8CBCnuL2ukC0TAc",o=n?n.replace(/\/$/,"").replace(/^(https?:\/\/)?/,"https://"):"https://placeholder.supabase.co";n&&a?a.length<50&&console.error("❌ Invalid Supabase anon key:",{keyLength:a.length,keyPreview:a.substring(0,30)+"...",message:"Anon key appears to be a placeholder or too short. Please check Vercel environment variables."}):(console.error("❌ Missing Supabase environment variables:",{url:n?"✓":"✗",key:a?"✓":"✗",urlValue:n||"MISSING",keyValue:a?"".concat(a.substring(0,20),"..."):"MISSING"}),console.error("Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in Vercel environment variables and redeploy."));let i=(0,t.eI)(o,a||"placeholder-key",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})}},function(e){e.O(0,[432,971,23,744],function(){return e(e.s=10)}),_N_E=e.O()}]);